# Быстрый запуск B2B платформы

## Запуск всех сервисов (4 простых шага)

### Вариант 1: Запуск каждого сервиса отдельно

1. **Chrome в режиме отладки**
   - Двойной клик: `1-start-chrome.bat`
   - Подождите 5 секунд

2. **Parser Service**
   - Двойной клик: `2-start-parser.bat`
   - Подождите 10 секунд

3. **Backend**
   - Двойной клик: `3-start-backend.bat`
   - Подождите 10 секунд

4. **Frontend**
   - Двойной клик: `4-start-frontend.bat`
   - Подождите 20 секунд

### Вариант 2: Автоматический запуск всего

- Двойной клик: `start-all.bat`
- Подождите ~40 секунд для запуска всех сервисов

---

## Проверка работоспособности

Откройте в браузере: **http://localhost:3000**

Все сервисы работают на следующих портах:
- **Frontend**: http://localhost:3000
- **Backend**: http://127.0.0.1:8000
- **Parser Service**: http://127.0.0.1:9003
- **Chrome CDP**: http://127.0.0.1:9222

### Проверка конфигурации

**Рекомендуется запускать после клонирования репозитория или обновления:**

- Двойной клик: `check-config.bat`
- Или в PowerShell: `.\check-config.ps1`

Скрипт проверит:
- ✅ Правильность портов в `.env.local`
- ✅ Правильность портов в `lib/api.ts`
- ✅ Правильность портов в скриптах запуска

**Если найдены ошибки** — скрипт укажет, что нужно исправить.

---

## Использование парсера

1. Откройте: http://localhost:3000/manual-parsing
2. Введите ключевое слово (например: "купить ноутбук")
3. Выберите глубину парсинга (1-50)
4. Выберите источник:
   - **Google** — парсинг только Google
   - **Yandex** — парсинг только Яндекса
   - **Both** — парсинг обоих источников
5. Нажмите **"Start Parsing"**
6. Дождитесь результатов (автообновление каждые 3 секунды)

---

## Что было исправлено

### 1. Chrome в режиме отладки
- **Проблема**: Chrome запускался в фоне и не был виден на рабочем столе
- **Решение**: Добавлены флаги для правильного запуска и вывода окна на передний план

### 2. Backend API
- **Проблема**: Backend запускался на неправильном порту (8001 вместо 8000)
- **Решение**: Исправлен `start-backend.ps1` для запуска на порту 8000

### 3. Frontend API URL
- **Проблема**: Frontend обращался к Backend на порту 8001 (неправильный порт)
- **Решение**: Исправлен `frontend/moderator-dashboard-ui/lib/api.ts` для использования порта 8000

### 4. Parser Service
- **Проблема**: Эмодзи в выводе вызывали ошибки на Windows
- **Решение**: Заменены все эмодзи на ASCII символы

### 5. Скрипты запуска
- **Проблема**: Скрипты не работали через Windows Terminal
- **Решение**: Созданы отдельные `.bat` файлы для каждого сервиса

---

## Остановка сервисов

Чтобы остановить все сервисы:

1. Закройте все окна командной строки (CMD) и PowerShell
2. Или используйте PowerShell команду:
   ```powershell
   Get-Process -Name "chrome", "python*", "node*" | Stop-Process -Force
   ```

---

## Устранение неполадок

### ⚠️ Ошибка: "ERR_CONNECTION_REFUSED :8001" (неправильный порт)

**Причина**: В файле `frontend/moderator-dashboard-ui/.env.local` указан неправильный порт

**Симптомы**:
- В Console DevTools показывает: `http://localhost:8001/moderator/manual-parsing`
- Ошибка: `net::ERR_CONNECTION_REFUSED`

**Решение**:
1. Запустите: `check-config.bat` для диагностики
2. Исправьте `frontend/moderator-dashboard-ui/.env.local`:
   ```
   NEXT_PUBLIC_API_URL=http://127.0.0.1:8000
   ```
3. Остановите Frontend (Ctrl+C в окне)
4. Удалите кеш: `Remove-Item -Recurse -Force frontend/moderator-dashboard-ui/.next`
5. Перезапустите Frontend: `4-start-frontend.bat`
6. В браузере: жесткая перезагрузка (Ctrl+Shift+R)

### Ошибка: "Parser service is currently unavailable"

**Причина**: Chrome не запущен в режиме отладки

**Решение**:
1. Закройте все Chrome процессы
2. Запустите `1-start-chrome.bat`
3. Подождите 5-10 секунд
4. Проверьте доступность: http://127.0.0.1:9222/json/version

### Ошибка: "Unable to connect to server"

**Причина**: Backend не запущен или работает на неправильном порту

**Решение**:
1. Проверьте, что Backend запущен через `3-start-backend.bat`
2. Проверьте доступность: http://127.0.0.1:8000/docs
3. Убедитесь, что в `frontend/moderator-dashboard-ui/lib/api.ts` используется порт 8000

### Frontend не запускается

**Причина**: Node.js процессы зависли

**Решение**:
1. Остановите все Node процессы:
   ```powershell
   Get-Process -Name "node*" | Stop-Process -Force
   ```
2. Перезапустите Frontend через `4-start-frontend.bat`

---

## Архитектура

```
┌─────────────────┐
│   Chrome CDP    │
│   Port: 9222    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ Parser Service  │
│   Port: 9003    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│    Backend      │
│   Port: 8000    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│    Frontend     │
│   Port: 3000    │
└─────────────────┘
```

---

## Дополнительная информация

- **Документация проекта**: `Docs/PROJECT-DOC.md`
- **Индекс документации**: `Docs/DOCS-INDEX.md`
- **Основной README**: `Docs/README.md`

---

**Дата последнего обновления**: 24 декабря 2025

